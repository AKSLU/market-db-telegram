# market-db-telegram

# üõí Market-DB + Telegram Bot

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–∏–Ω–∏-–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —Å –≤–µ–±-–ø–∞–Ω–µ–ª—å—é (Flask) –∏ Telegram-–±–æ—Ç–æ–º, —Ä–∞–±–æ—Ç–∞—é—â–∏–º —á–µ—Ä–µ–∑ PostgreSQL.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

### **üîπ Telegram-–±–æ—Ç**

–ë–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
* –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ 5 –¥–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π **/buy**
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
* –•—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ PostgreSQL

–§—É–Ω–∫—Ü–∏–∏:

* `check_subscription()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
* `activate_subscription()` ‚Äî –≤—ã–¥–∞—á–∞ / –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

---

### **üîπ –í–µ–±-–ø–∞–Ω–µ–ª—å (Flask)**

–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ / –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–∫–ª—é—á–∞–µ—Ç:

#### **1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**

–§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –ø–æ –ª–æ–≥–∏–Ω—É –∏ –ø–∞—Ä–æ–ª—é
(`users` —Ç–∞–±–ª–∏—Ü–∞ –≤ PostgreSQL)

#### **2. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤**

–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/items` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:

* –Ω–∞–∑–≤–∞–Ω–∏–µ
* —Ü–µ–Ω—É
* –æ–ø–∏—Å–∞–Ω–∏–µ
* —Ñ–æ—Ç–æ
* –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
* –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞

–ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ **–ö—É–ø–∏—Ç—å**, –∫–æ—Ç–æ—Ä–∞—è:

* —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ
* —É–º–µ–Ω—å—à–∞–µ—Ç –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–∫—É–ø–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É `buys`

#### **3. –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫**

–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/buys` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

* ID –ø–æ–∫—É–ø–∫–∏
* –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
* –°—Ç–æ–∏–º–æ—Å—Ç—å
* –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îÇ
‚îú‚îÄ‚îÄ telegram.py        # Telegram-–±–æ—Ç
‚îú‚îÄ‚îÄ app.py             # Flask –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
‚îÇ
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ login.html     # –í—Ö–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ items.html     # –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ buys.html      # –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
‚îÇ
‚îî‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üõ¢ –¢—Ä–µ–±—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã PostgreSQL

### –¢–∞–±–ª–∏—Ü–∞ `users`

```
user_id SERIAL PRIMARY KEY
username TEXT
password TEXT
balance INTEGER
```

### –¢–∞–±–ª–∏—Ü–∞ `items2`

```
id SERIAL PRIMARY KEY
name TEXT
price INTEGER
description TEXT
image_url TEXT
supplier TEXT
```

### –¢–∞–±–ª–∏—Ü–∞ `quantity`

```
id INTEGER REFERENCES items2(id)
count INTEGER
```

### –¢–∞–±–ª–∏—Ü–∞ `buys`

```
id SERIAL PRIMARY KEY
item_name TEXT
cost INTEGER
user_id INTEGER REFERENCES users(user_id)
```

### –¢–∞–±–ª–∏—Ü–∞ `subscriptions`

```
tg_login TEXT PRIMARY KEY
is_buy BOOLEAN
buy_date TIMESTAMP
expire_date TIMESTAMP
```

---

## ‚ñ∂ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### **1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

```
pip install flask psycopg2-binary pyTelegramBotAPI
```

### **2. –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü—ã**

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL –∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤—ã—à–µ.

### **3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ**

–î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ç–æ–≤–∞—Ä—ã, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.

### **4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Telegram-–±–æ—Ç–∞**

```
python telegram.py
```

### **5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–ø–∞–Ω–µ–ª—å**

```
python app.py
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:

```
http://127.0.0.1:5000
```

---

## ‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –í `telegram.py` –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```
TOKEN = "–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê"
user="postgres"
password="–≤–∞—à_–ø–∞—Ä–æ–ª—å"
```

### –í `app.py`:

```
user="postgres"
password="–≤–∞—à_–ø–∞—Ä–æ–ª—å"
```

---
